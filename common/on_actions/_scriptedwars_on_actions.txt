on_actions = {
	on_capitulation_immediate = {
		effect = {
			ROOT = {
				white_peace = FROM
				if = {
					limit = {
						is_faction_leader = yes
					}
					dismantle_faction = yes
				}
				if = {
					limit = {
						is_in_faction = yes
					}
					leave_faction = yes
				}
				every_subject_country = {
					ROOT = {
						end_puppet = PREV
					}
					FROM = {
						declare_war_on = {
							target = PREV
							type = annex_puppet_wargoal
						}
					}
				}
			}
			if = {
				limit = {
					FROM = {
						has_idea = digital_democracy
						is_in_faction = yes
					}
				}
				FROM = {
					FACTION_LEADER = {
						add_to_faction = ROOT
						puppet_government_too = yes
					}
				}
			}
			else = {
				FROM = {
					if = {
						limit = {
							FROM = {
								is_puppet = yes
							}
						}
						FROM.OVERLORD = {
							puppet = ROOT
							puppet_government_too = yes
						}
					}
					else = {
						puppet = ROOT
						puppet_government_too = yes
					}				
				}
			}
			ROOT = {
				every_owned_state = {
					limit = {
						OR = {
							is_core_of = FROM
							is_claimed_by = FROM
						}
					}
					transfer_state_to = FROM
				}
			}
			FROM = {
				add_to_array = {
					array = global.winning_country
					value = THIS.id
					index = 0
				}
			}
			ROOT = {
				add_to_array = {
					array = global.losing_country
					value = THIS.id
					index = 0
				}
			}
			every_country = {
				limit = {
					is_ai = no
				}
				set_country_flag = country_has_been_defeated
			}
		}
	}
	on_capitulation = {
		effect = {
			ROOT = {
				every_owned_state = {
					transfer_state_to = ROOT
				}
			}
		}
	}
	###
	on_capitulation_immediate = { #ROOT is looser, FROM is winner
		effect = {
			if = {
				limit = {
					NOT = {
						has_global_flag = euro_war_happened
					}
				}
				#YUG-ROM WAR
				if = {
					limit = {
						ROOT = {
							tag = ROM
						}
						FROM = {
							tag = YUG
						}
					}
					FRA = {
						white_peace = SOV
						white_peace = YUG
					}
				}
				#ROM-YUG WAR
				else_if = {
					limit = {
						ROOT = {
							tag = YUG
						}
						FROM = {
							tag = ROM
						}
					}
					SOV = {
						white_peace = FRA
						white_peace = ROM
					}
				}
				#SWE-NOR WAR
				else_if = {
					limit = {
						ROOT = {
							tag = NOR
						}
						FROM = {
							tag = SWE
						}
					}
					SCO = {
						white_peace = SWE
						white_peace = GER
					}
				}
				#NOR-SWE WAR
				else_if = {
					limit = {
						ROOT = {
							tag = SWE
						}
						FROM = {
							tag = NOR
						}
					}
					GER = {
						white_peace = SCO
						white_peace = NOR
					}
				}
				else = {
					#
				}
			}
			else = {
				#
			}			
		}
	}
	###
	on_puppet = {
		effect = {
			puppet_government_too = yes
		}
	}
	###
	on_release_as_puppet = {
		effect = {
			puppet_government_too = yes
		}
	}
}
