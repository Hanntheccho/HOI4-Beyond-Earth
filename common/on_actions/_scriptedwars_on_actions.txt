on_actions = {
	###
	on_declare_war = {
		effect = {
			every_country = {
				if = {
					limit = {
						any_guaranteed_country = {
							tag = FROM
						}
					}
					declare_war_on = {
						target = ROOT
						type = puppet_wargoal_focus
					}
				}
			}
		}
	}
	#
	on_puppet = { #ROOT is the puppet tag, FROM is OVERLORD
		effect = {
			ROOT = {
				every_owned_state = {
					limit = {
						OR = {
							is_claimed_by = FROM
							is_core_of = FROM
						}
					}
					transfer_state_to = FROM
				}
			}
		}
	}
	#
	on_peaceconference_ended = { #FROM is looser, ROOT is winner
		effect = {
			if = {
				limit = {
					has_global_flag = final_war_flag
				}
				log = "A WAR HAS ENDED!"
			}
			#CHINA
			else_if = {
				limit = {
					FROM = {
						is_china_tag = yes
					}
					ROOT = {
						tag = CHI
					}
					NOT = {
						any_country = {
							is_china_tag = yes
						}
					}
				}
				CHI = {
					drop_cosmetic_tag = yes
				}
			}
			#POL-LAT WAR
			else_if = {
				limit = {
					FROM = {
						tag = LAT
					}
					ROOT = {
						tag = POL
					}
				}
				POL = {
					end_puppet = LAT
				}
				GER = {
					add_to_faction = LAT
				}
				LAT = {
					set_politics = {
						ruling_party = harmony
					}
					retire_ideology_leader = harmony
					create_country_leader = {
						name = "INTEGR Committee"
						ideology = harmony_ideology
						picture = GFX_portrait_government_character_harmony
					}
					add_ideas = GER_german_aligned
				}
			}
			#KAR-SOV WAR
			else_if = {
				limit = {
					FROM = {
						tag = SOV
					}
					ROOT = {
						tag = KAR
					}
				}
				KAR = {
					country_event = { 
						id = karelia_event.5
						days = 0
					}
					country_event = { 
						id = karelia_event.6
						days = 25
					}
					FROM = {
						every_owned_state = {
							remove_core_of = FROM
							add_core_of = ROOT
							transfer_state_to = ROOT
						}
					}
					set_cosmetic_tag = KAR_russia
				}
			}
			#KAZ-URA WAR
			else_if = {
				limit = {
					FROM = {
						tag = URA
					}
					ROOT = {
						tag = KAZ
					}
				}
				FROM = {
					remove_ideas = URA_no_army
					set_cosmetic_tag = URA_democratic
				}
			}
			#COS-URG-BRA WAR
			else_if = {
				limit = {
					FROM = {
						tag = URG
						is_puppet_of = COS
						any_core_state = {
							is_owned_by = BGV
						}
					}
					ROOT = {
						tag = COS
					}
				}
				FROM = {
					every_core_state = {
						transfer_state_to = FROM
					}
				}
				BGV = {
					transfer_state = 176
					transfer_state = 185
				}
			}
			#DOS-CAS WAR
			else_if = {
				limit = {
					FROM = {
						tag = CAS
					}
					ROOT = {
						tag = DOS
					}
				}
				ROOT = {
					every_owned_state = {
						limit = {
							is_core_of = FROM
						}
						remove_core_of = FROM
					}
				}
				ARC = {
					add_to_faction = ROOT
				}
			}
			#CAS-DOS WAR
			else_if = {
				limit = {
					FROM = {
						tag = DOS
					}
					ROOT = {
						tag = CAS
					}
				}
				ROOT = {
					every_owned_state = {
						limit = {
							is_core_of = FROM
						}
						remove_core_of = FROM
					}
					add_ideas = NAU_central_authority_low
				}
				PNM = {
					add_to_faction = ROOT
				}
			}
			#TRE-ONU WAR
			else_if = {
				limit = {
					FROM = {
						tag = ONU
					}
					ROOT = {
						tag = TRE
					}
				}
				ROOT = {
					annex_country = {
						target = FROM
					}
					every_owned_state = {
						limit = {
							is_core_of = FROM
						}
						remove_core_of = FROM
					}
				}
				ARC = {
					add_to_faction = ROOT
				}
			}
			#DOS-SIL WAR
			else_if = {
				limit = {
					FROM = {
						tag = SIL
					}
					ROOT = {
						tag = DOS
					}
				}
				ROOT = {
					remove_ideas = DOS_to_the_coast
					every_owned_state = {
						limit = {
							is_core_of = FROM
						}
						remove_core_of = FROM
					}
					set_capital = { #gives error if capital set to 12 in history file ;_;
						state = 12
						remember_old_capital = no
					}
				}
			}
			#ONE-CAL WAR
			else_if = {
				limit = {
					FROM = {
						tag = CAL
					}
					ROOT = {
						tag = ONE
					}
				}
				ROOT = {
					annex_country = {
						target = FROM
					}
					every_owned_state = {
						limit = {
							is_core_of = FROM
						}
						remove_core_of = FROM
					}
				}
				PNM = {
					add_to_faction = ROOT
				}
			}
			#TZN-COG WAR
			else_if = {
				limit = {
					FROM = {
						OR = {
							tag = COG
							tag = SAF
							tag = ANG
						}
						is_puppet_of = ROOT
					}
					ROOT = {
						tag = TZN
					}
				}
				FROM = {
					every_owned_state = {
						remove_core_of = FROM
						add_core_of = ROOT
						transfer_state_to = ROOT
					}
				}
				ROOT = {
					set_cosmetic_tag = TZN_AFRICA
				}
			}
			#GRP-BGV WAR
			else_if = {
				limit = {
					FROM = {
						tag = BGV
					}
					ROOT = {
						tag = GRP
					}
				}
				FROM = {
					every_owned_state = {
						remove_core_of = FROM
						add_core_of = ROOT
						transfer_state_to = ROOT
					}
				}
				ROOT = {
					set_cosmetic_tag = GRP_BRA
				}
			}
			#BGV-LEG WAR
			else_if = {
				limit = {
					FROM = {
						tag = LEG
					}
					ROOT = {
						tag = BGV
					}
				}
				FROM = {
					every_core_state = {
						remove_core_of = FROM
					}
				}
			}
			#PAD-ITA WAR
			else_if = {
				limit = {
					FROM = {
						tag = ITA
					}
					ROOT = {
						tag = PAD
					}
				}
				ITA = {
					every_core_state = {
						add_core_of = PAD
						transfer_state_to = PAD
					}
				}
				PAD = {
					set_cosmetic_tag = PAD_italy
					set_capital = {
						state = 334
						#remember_old_capital = no #?
					}
				}
			}
			#COS-ARG WAR
			else_if = {
				limit = {
					FROM = {
						tag = ARG
					}
					ROOT = {
						tag = COS
					}
				}
				FROM = {
					every_core_state = {
						remove_core_of = FROM
						add_core_of = ROOT
						transfer_state_to = ROOT
					}
				}
				ROOT = {
					set_cosmetic_tag = ARG_COS
					set_capital = {
						state = 154
						remember_old_capital = no
					}
				}
			}
			#ARG-COS WAR
			else_if = {
				limit = {
					FROM = {
						tag = COS
					}
					ROOT = {
						tag = ARG
					}
				}
				FROM = {
					every_core_state = {
						remove_core_of = FROM
						add_core_of = ROOT
						transfer_state_to = ROOT
					}
				}
				ROOT = {
					set_cosmetic_tag = ARG_ARG
				}
				PRU = { #SHOULD BE REMOVED FROM HERE SOMEHOW!
					add_to_faction = ARG
					add_to_faction = CHL
				}
			}
			#COS-CHL WAR
			else_if = {
				limit = {
					FROM = {
						tag = CHL
					}
					ROOT = {
						tag = COS
					}
				}
				FROM = {
					every_core_state = {
						#remove_core_of = FROM
						add_core_of = ROOT
						transfer_state_to = ROOT
					}
				}
				ROOT = {
					set_cosmetic_tag = COS_CHL
				}
			}
			#GER-FRA WAR
			else_if = {
				limit = {
					FROM = {
						tag = FRA
					}
					ROOT = {
						tag = GER
					}
				}
				FRA = {
					release = SPR
					set_cosmetic_tag = FRA_FRA
				}
				GER = {
					puppet = SPR
				}
			}
			else = {
				#
			}
		}
	}
	###
	on_capitulation_immediate = { #ROOT is looser, FROM is winner
		effect = {
			#YUG-ROM WAR
			if = {
				limit = {
					ROOT = {
						tag = ROM
					}
					FROM = {
						tag = YUG
					}
				}
				FRA = {
					white_peace = SOV
					white_peace = YUG
				}
			}
			#ROM-YUG WAR
			else_if = {
				limit = {
					ROOT = {
						tag = YUG
					}
					FROM = {
						tag = ROM
					}
				}
				SOV = {
					white_peace = FRA
					white_peace = ROM
				}
			}
		}
	}
}
