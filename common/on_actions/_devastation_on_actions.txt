on_actions = {
	on_startup = {
		effect = {
			every_country = {
				limit = {
					is_ai = no
				}
				set_country_flag = auto_reduce_devastation_enabled
			}
            set_variable = { devastation_chance = threat }
			#ADDING DYNAMIC MODIFIERS
            every_state = {
				if = {
					limit = {
						OR = {
							is_owned_by = ADU
						}
					}
					add_dynamic_modifier = {
						modifier = terminal_devastation
					}
				}
				else_if = {
					limit = {
						OR = {
							state = 16
							state = 14
						}
					}
					add_dynamic_modifier = {
						modifier = terminal_devastation
					}
				}
				else_if = {
					limit = {
						OR = {
							state = 18
							state = 19
							state = 949
						}
					}
					add_dynamic_modifier = {
						modifier = major_devastation
					}
				}
				else_if = {
					limit = {
						OR = {
							state = 113
							state = 13
							state = 23
						}
					}
					add_dynamic_modifier = {
						modifier = notable_devastation
					}
				}
				else_if = {
					limit = {
						OR = {
							#has_resources_amount = {
							#	resource = oil
							#	amount > 100
							#}
							has_resources_amount = {
								resource = aluminium
								amount > 100
							}
							has_resources_amount = {
								resource = rubber
								amount > 100
							}
							has_resources_amount = {
								resource = tungsten
								amount > 100
							}
							has_resources_amount = {
								resource = steel
								amount > 100
							}
							has_resources_amount = {
								resource = chromium
								amount > 100
							}
							OR = {
								check_variable = {
									building_level@industrial_complex > 5
								}
								check_variable = {
									building_level@arms_factory > 5
								}
							}
						}
					}
					add_dynamic_modifier = {
						modifier = significant_devastation
					}
				}
				else_if = {
					limit = {
						OR = {
							#has_resources_amount = {
							#	resource = oil
							#	amount > 50
							#}
							has_resources_amount = {
								resource = aluminium
								amount > 50
							}
							has_resources_amount = {
								resource = rubber
								amount > 50
							}
							has_resources_amount = {
								resource = tungsten
								amount > 50
							}
							has_resources_amount = {
								resource = steel
								amount > 50
							}
							has_resources_amount = {
								resource = chromium
								amount > 50
							}
							OR = {
								check_variable = {
									building_level@industrial_complex > 2
								}
								check_variable = {
									building_level@arms_factory > 2
								}
							}
						}
					}
					add_dynamic_modifier = {
						modifier = major_devastation
					}
				}
				else_if = {
					limit = {
						OR = {
							#has_resources_amount = {
							#	resource = oil
							#	amount > 10
							#}
							has_resources_amount = {
								resource = aluminium
								amount > 10
							}
							has_resources_amount = {
								resource = rubber
								amount > 10
							}
							has_resources_amount = {
								resource = tungsten
								amount > 10
							}
							has_resources_amount = {
								resource = steel
								amount > 10
							}
							has_resources_amount = {
								resource = chromium
								amount > 10
							}
						}
					}
					add_dynamic_modifier = {
						modifier = notable_devastation
					}
				}
				else = {
					add_dynamic_modifier = {
						modifier = minor_devastation
					}
				}
            }
			###
            every_country = {
                set_variable = { devastation_timeout = 60 }
				calculate_current_devastation = yes
                set_variable = { max_devastation = num_controlled_states }
                multiply_variable = { max_devastation = 4 }
                set_variable = { devastation_modifier = 1 }
                set_variable = { devastation_ratio = ROOT.current_devastation }
                divide_variable = { devastation_ratio = max_devastation }
                #set_variable = { devastation_ratio_new_factory = num_of_civilian_factories }
                #multiply_variable = { devastation_ratio_new_factory = 1.25 }
                #add_to_variable = { devastation_ratio_new_factory = num_of_military_factories }
                #add_to_variable = { devastation_ratio_new_factory = num_of_naval_factories }
				#set_variable = { ROOT.devastation_ratio_new_population = 0 }
				#every_owned_state = {
				#	limit = {
				#		NOT = {
				#			is_core_of = ROOT
				#		}
				#	}
				#	add_to_variable = { ROOT.devastation_ratio_new_population = THIS.state_population_k }
				#}
				#divide_variable = { devastation_ratio_new_population = 4 }
				#add_to_variable = { devastation_ratio_new_population = max_manpower_k }
				#round_variable = devastation_ratio_new_population
				#set_variable = { devastation_ratio_new = devastation_ratio_new_factory }
				#divide_variable = { devastation_ratio_new = devastation_ratio_new_population }
				#round_variable = devastation_ratio_new
				if = {
					limit = {
						check_variable = { devastation_ratio < 0.01 }
					}
					remove_ideas = mobilizing_society
					remove_ideas = flaking_society
					remove_ideas = crumbling_society
					remove_ideas = periphal_anarchy
					remove_ideas = stable_society
					add_ideas = utopian_society
				}
				else_if = {
					limit = {
						check_variable = { devastation_ratio < 0.2 }
					}
					remove_ideas = mobilizing_society
					remove_ideas = flaking_society
					remove_ideas = crumbling_society
					remove_ideas = periphal_anarchy
					add_ideas = stable_society
				}
				else_if = {
					limit = {
						check_variable = { devastation_ratio < 0.4 }
					}
					remove_ideas = stable_society
					remove_ideas = flaking_society
					remove_ideas = crumbling_society
					remove_ideas = periphal_anarchy
					add_ideas = mobilizing_society
				}
				else_if = {
					limit = {
						check_variable = { devastation_ratio < 0.6 }
					}
					remove_ideas = stable_society
					remove_ideas = mobilizing_society
					remove_ideas = crumbling_society
					remove_ideas = periphal_anarchy
					add_ideas = flaking_society
				}
				else_if = {
					limit = {
						check_variable = { devastation_ratio < 0.8 }
					}
					remove_ideas = stable_society
					remove_ideas = flaking_society
					remove_ideas = mobilizing_society
					remove_ideas = periphal_anarchy
					add_ideas = crumbling_society
				}
				else = {
					remove_ideas = stable_society
					remove_ideas = flaking_society
					remove_ideas = mobilizing_society
					remove_ideas = crumbling_society
					add_ideas = periphal_anarchy
				}
            }
            #every_state = {
            #    set_variable = { devastation_degree = 3 }
            #}
        }
    }
	on_daily = {
		effect = {
            subtract_from_variable = { devastation_timeout = 1 }
            if = {
                limit = {
                    check_variable = { devastation_timeout = 0 }
					threat < 0.11
                }
				random_list = {
					50 = {
						increase_devastation_random_state = yes
					}
					50 = {

					}
				}
                add_to_variable = { devastation_timeout = 60 }
            }
            else_if = {
                limit = {
                    check_variable = { devastation_timeout = 0 }
					threat < 0.21
					threat > 0.10
				}
				random_list = {
					55 = {
						increase_devastation_random_state = yes
					}
					45 = {

					}
				}
                add_to_variable = { devastation_timeout = 60 }
            }
            else_if = {
                limit = {
                    check_variable = { devastation_timeout = 0 }
					threat < 0.31
					threat > 0.20
				}
				random_list = {
					60 = {
						increase_devastation_random_state = yes
					}
					40 = {

					}
				}
                add_to_variable = { devastation_timeout = 60 }
            }
            else_if = {
                limit = {
                    check_variable = { devastation_timeout = 0 }
					threat < 0.41
					threat > 0.30
				}
				random_list = {
					65 = {
						increase_devastation_random_state = yes
					}
					35 = {

					}
				}
                add_to_variable = { devastation_timeout = 60 }
            }
            else_if = {
                limit = {
					check_variable = { devastation_timeout = 0 }
					threat < 0.51
					threat > 0.40
				}
				random_list = {
					70 = {
						increase_devastation_random_state = yes
					}
					30 = {

					}
				}
                add_to_variable = { devastation_timeout = 30 }
            }
            else_if = {
                limit = {
                    check_variable = { devastation_timeout = 0 }
					threat < 0.61
					threat > 0.50
				}
				random_list = {
					75 = {
						increase_devastation_random_state = yes
					}
					25 = {

					}
				}
                add_to_variable = { devastation_timeout = 30 }
            }
            else_if = {
                limit = {
                    check_variable = { devastation_timeout = 0 }
					threat < 0.71
					threat > 0.60
				}
				random_list = {
					80 = {
						increase_devastation_random_state = yes
					}
					20 = {

					}
				}
                add_to_variable = { devastation_timeout = 30 }
            }
            else_if = {
                limit = {
                    check_variable = { devastation_timeout = 0 }
					threat < 0.81
					threat > 0.70
				}
				random_list = {
					85 = {
						increase_devastation_random_state = yes
					}
					15 = {

					}
				}
                add_to_variable = { devastation_timeout = 20 }
            }
            else_if = {
                limit = {
                    check_variable = { devastation_timeout = 0 }
					threat < 0.91
					threat > 0.80
				}
				random_list = {
					90 = {
						increase_devastation_random_state = yes
					}
					10 = {

					}
				}
                add_to_variable = { devastation_timeout = 20 }
            }
            else_if = {
                limit = {
                    check_variable = { devastation_timeout = 0 }
					threat > 0.9
                }
				random_list = {
					95 = {
						increase_devastation_random_state = yes
					}
					5 = {

					}
				}
                add_to_variable = { devastation_timeout = 20 }
            }
        }
    }
	on_weekly = {
		effect = {
			if = {
				limit = {
					has_country_flag = auto_reduce_devastation_enabled
					check_variable = {
						industrial_power > 200
					}
					NOT = {
						OR = {
							has_government = harmony
							has_country_flag = has_mind_tier3
						}
					}
					any_owned_state = {
						NOT = {
							has_state_flag = devastation_reduction_timeout_flag
						}
					}
				}
				add_to_variable = {
					industrial_power = -25
				}
				random_owned_state = {
					limit = {
						NOT = {
							has_state_flag = devastation_reduction_timeout_flag
						}
					}
					decrease_devastation = yes
				}
			}
			else_if = {
				limit = {
					has_country_flag = auto_reduce_devastation_enabled
					check_variable = {
						industrial_power > 200
					}
					OR = {
						has_government = harmony
						has_country_flag = has_mind_tier3
					}
					any_owned_state = {
						NOT = {
							has_state_flag = devastation_reduction_timeout_flag
						}
					}
				}
				add_to_variable = {
					industrial_power = -40
				}
				random_owned_state = {
					limit = {
						NOT = {
							has_state_flag = devastation_reduction_timeout_flag
						}
					}
					decrease_devastation = yes
				}
			}
			else = {

			}
			calculate_current_devastation = yes
			clear_variable = max_devastation
            set_variable = { max_devastation = num_controlled_states }
            multiply_variable = { max_devastation = 4 }
            multiply_variable = { devastation_modifier = 5 }
			clear_variable = devastation_ratio
			set_variable = { devastation_ratio = ROOT.current_devastation }
			divide_variable = { devastation_ratio = max_devastation }
			if = {
				limit = {
					check_variable = { devastation_ratio < 0.01 }
				}
				remove_ideas = mobilizing_society
				remove_ideas = flaking_society
				remove_ideas = crumbling_society
				remove_ideas = periphal_anarchy
				remove_ideas = stable_society
				add_ideas = utopian_society
			}
			else_if = {
				limit = {
					check_variable = { devastation_ratio < 0.2 }
				}
				remove_ideas = mobilizing_society
				remove_ideas = flaking_society
				remove_ideas = crumbling_society
				remove_ideas = periphal_anarchy
				add_ideas = stable_society
			}
			else_if = {
				limit = {
					check_variable = { devastation_ratio < 0.4 }
				}
				remove_ideas = stable_society
				remove_ideas = flaking_society
				remove_ideas = crumbling_society
				remove_ideas = periphal_anarchy
				add_ideas = mobilizing_society
			}
			else_if = {
				limit = {
					check_variable = { devastation_ratio < 0.6 }
				}
				remove_ideas = stable_society
				remove_ideas = mobilizing_society
				remove_ideas = crumbling_society
				remove_ideas = periphal_anarchy
				add_ideas = flaking_society
			}
			else_if = {
				limit = {
					check_variable = { devastation_ratio < 0.8 }
				}
				remove_ideas = stable_society
				remove_ideas = flaking_society
				remove_ideas = mobilizing_society
				remove_ideas = periphal_anarchy
				add_ideas = crumbling_society
			}
			else = {
				remove_ideas = stable_society
				remove_ideas = flaking_society
				remove_ideas = mobilizing_society
				remove_ideas = crumbling_society
				add_ideas = periphal_anarchy
			}
		}
	}
	###
	#MONTHLY INCREASING WORLD TENSION
	on_monthly_ADU = {
		effect = {
			if = {
				limit = {
					threat < 1
				}
				set_variable = { global.total_global_devastation = 0 }
				every_state = {
					if = {
						limit = {
							has_dynamic_modifier = {
								modifier = terminal_devastation
							}
						}
						add_to_variable = {
							global.total_global_devastation = 4
						}
					}
					if = {
						limit = {
							has_dynamic_modifier = {
								modifier = significant_devastation
							}
						}
						add_to_variable = {
							global.total_global_devastation = 3
						}
					}
					if = {
						limit = {
							has_dynamic_modifier = {
								modifier = major_devastation
							}
						}
						add_to_variable = {
							global.total_global_devastation = 2
						}
					}
					if = {
						limit = {
							has_dynamic_modifier = {
								modifier = notable_devastation
							}
						}
						add_to_variable = {
							global.total_global_devastation = 1
						}
					}
				}
				divide_variable = { global.total_global_devastation = 800 } #1000
				random_country = {
					limit = {
						owns_state = 333
					}
					add_named_threat = { 
						threat = global.total_global_devastation
						name = total_global_devastation_added
					}
				}
			}
		}
	}
	###
}