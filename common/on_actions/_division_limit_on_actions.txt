on_actions = {
    on_startup = {
        effect = {
            every_country = {
                set_variable = { division_limit = num_of_military_factories }
                multiply_variable = { division_limit = 2 }                     
            }
            every_country = {
                if = {
                    limit = {
                        check_variable = {
                            num_of_military_factories > 5
                        }
                        has_tech = heavy_weapons
                    }
                    capital_scope = {
                        add_building_construction = {
                            type = heavy_military_complex
                            level = 2
                            instant_build = yes
                        }
                    }
                }
                else_if = {
                    limit = {
                        check_variable = {
                            num_of_military_factories > 0
                        }
                        has_tech = heavy_weapons
                    }
                    capital_scope = {
                        add_building_construction = {
                            type = heavy_military_complex
                            level = 1
                            instant_build = yes
                        }
                    }
                }
                else = {
                    #
                }
            }
        }
    }
    ###
    on_daily = {
        effect = {
            set_variable = { division_limit = num_of_military_factories }
            set_variable = { 
                division_limit_heavy_arms_factories = 0 
            }
            every_controlled_state = {
                add_to_variable = { 
                    PREV.division_limit_heavy_arms_factories = building_level@heavy_military_complex 
                }
            }
            add_to_variable = {
                division_limit = division_limit_heavy_arms_factories
            }
            multiply_variable = { division_limit = 2 }
            round_variable = division_limit
            clamp_variable = { var = division_limit min = 0 max = 250 }
            if = {
                limit = {
                    check_variable = { num_divisions > division_limit }
                }
                clear_variable = too_many_divs_var
            	set_variable = { too_many_divs_var = division_limit }
            	divide_variable = { too_many_divs_var = num_divisions }
                multiply_variable = { too_many_divs_var = -1 }
                add_to_variable = { too_many_divs_var = 1 }
                multiply_variable = { too_many_divs_var = -1 }
                clamp_variable = { var = too_many_divs_var min = -0.75 max = 0 }
                if = {
                    limit = {
                        NOT = {
                            has_dynamic_modifier = { modifier = too_many_divs }
                        }
                    }
                    add_dynamic_modifier = {
                        modifier = too_many_divs
                    }
                }                
            }
            else = {
                clear_variable = too_many_divs_var
            }
        }
    }
}
