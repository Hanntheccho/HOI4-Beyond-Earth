on_actions = {
    on_startup = {
        effect = {
            every_country = {
                set_variable = { division_limit = num_of_military_factories }
                set_variable = { 
                    division_limit_heavy_arms_factories = 0 
                }
                every_controlled_state = {
                    add_to_variable = { 
                        PREV.division_limit_heavy_arms_factories = building_level@heavy_military_complex 
                    }
                }
                add_to_variable = {
                    division_limit = division_limit_heavy_arms_factories
                }
                multiply_variable = { division_limit = 20 }                     
            }
        }
    }
    ###
    on_daily = {
        effect = {
            set_variable = { division_limit = num_of_military_factories }
            set_variable = { 
                division_limit_heavy_arms_factories = 0 
            }
            every_controlled_state = {
                add_to_variable = { 
                    PREV.division_limit_heavy_arms_factories = building_level@heavy_military_complex 
                }
            }
            add_to_variable = {
                division_limit = division_limit_heavy_arms_factories
            }
            multiply_variable = { division_limit = 20 }
            #
            if = {
                limit = {
                    has_idea = service_by_requirement
                }
                multiply_variable = { division_limit = 1.2 }
            }
            else_if = {
                limit = {
                    has_idea = extensive_conscription
                }
                multiply_variable = { division_limit = 1.1 }
            }
            else_if = {
                limit = {
                    has_idea = volunteer_only
                }
                multiply_variable = { division_limit = 0.9 }
            }
            else = {
                #
            }
            #
            if = {
                limit = {
                    has_idea = autocratic_authority
                }
                multiply_variable = { division_limit = 1.1 }
            }
            if = {
                limit = {
                    has_idea = ENG_civil_war_recovery
                }
                multiply_variable = { division_limit = 0.5 }
            }
            if = {
                limit = {
                    has_idea = SOV_centralized_military
                }
                multiply_variable = { division_limit = 1.05 }
            }
            if = {
                limit = {
                    has_idea = TZN_army_of_the_people
                }
                multiply_variable = { division_limit = 1.25 }
            }
            if = {
                limit = {
                    has_idea = ARC_the_anthill
                }
                multiply_variable = { division_limit = 1.25 }
            }
            #
            round_variable = division_limit
            clamp_variable = { var = division_limit min = 0 max = 2500 }
            if = {
                limit = {
                    check_variable = { num_battalions > division_limit }
                }
                clear_variable = too_many_divs_var
            	set_variable = { too_many_divs_var = division_limit }
            	divide_variable = { too_many_divs_var = num_battalions }
                multiply_variable = { too_many_divs_var = -1 }
                add_to_variable = { too_many_divs_var = 1 }
                multiply_variable = { too_many_divs_var = -1 }
                clamp_variable = { var = too_many_divs_var min = -0.75 max = 0 }
                if = {
                    limit = {
                        NOT = {
                            has_dynamic_modifier = { modifier = too_many_divs }
                        }
                    }
                    add_dynamic_modifier = {
                        modifier = too_many_divs
                    }
                }                
            }
            else = {
                clear_variable = too_many_divs_var
            }
        }
    }
}
