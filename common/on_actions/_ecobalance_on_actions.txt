on_actions = {
	on_nuke_drop = {
		effect = {
			FROM = {
				increase_devastation = yes
			}
		}
	}
###
	on_startup = {
		effect = {
			every_possible_country = {
				set_country_flag = auto_ecobalance_states
			}
            every_state = {
				if = {
					limit = {
						OR = {
							is_owned_by = ADU
							state = 16
							state = 14
						}
					}
					add_dynamic_modifier = {
						modifier = terminal_devastation
					}
				}
				else_if = {
					limit = {
						OR = {
							state = 688
							state = 949
						}
					}
					add_dynamic_modifier = {
						modifier = significant_devastation
					}
				}
				else_if = {
					limit = {
						OR = {
							state = 18
							state = 19
							state = 949
							state = 687
							state = 694
						}
					}
					add_dynamic_modifier = {
						modifier = major_devastation
					}
				}
				else_if = {
					limit = {
						OR = {
							state = 113
							state = 13
							state = 23
							state = 734
							state = 789
						}
					}
					add_dynamic_modifier = {
						modifier = notable_devastation
					}
				}
				else_if = {
					limit = {
						OR = {
							#has_resources_amount = {
							#	resource = oil
							#	amount > 100
							#}
							has_resources_amount = {
								resource = aluminium
								amount > 100
							}
							has_resources_amount = {
								resource = rubber
								amount > 100
							}
							has_resources_amount = {
								resource = tungsten
								amount > 100
							}
							has_resources_amount = {
								resource = steel
								amount > 100
							}
							has_resources_amount = {
								resource = chromium
								amount > 100
							}
							OR = {
								check_variable = {
									building_level@industrial_complex > 5
								}
								check_variable = {
									building_level@arms_factory > 5
								}
							}
						}
					}
					add_dynamic_modifier = {
						modifier = significant_devastation
					}
				}
				else_if = {
					limit = {
						OR = {
							#has_resources_amount = {
							#	resource = oil
							#	amount > 50
							#}
							has_resources_amount = {
								resource = aluminium
								amount > 50
							}
							has_resources_amount = {
								resource = rubber
								amount > 50
							}
							has_resources_amount = {
								resource = tungsten
								amount > 50
							}
							has_resources_amount = {
								resource = steel
								amount > 50
							}
							has_resources_amount = {
								resource = chromium
								amount > 50
							}
							OR = {
								check_variable = {
									building_level@industrial_complex > 2
								}
								check_variable = {
									building_level@arms_factory > 2
								}
							}
						}
					}
					add_dynamic_modifier = {
						modifier = major_devastation
					}
				}
				else_if = {
					limit = {
						OR = {
							#has_resources_amount = {
							#	resource = oil
							#	amount > 10
							#}
							has_resources_amount = {
								resource = aluminium
								amount > 10
							}
							has_resources_amount = {
								resource = rubber
								amount > 10
							}
							has_resources_amount = {
								resource = tungsten
								amount > 10
							}
							has_resources_amount = {
								resource = steel
								amount > 10
							}
							has_resources_amount = {
								resource = chromium
								amount > 10
							}
						}
					}
					add_dynamic_modifier = {
						modifier = notable_devastation
					}
				}
				else = {
					add_dynamic_modifier = {
						modifier = minor_devastation
					}
				}
            }
			every_state = { #fires of Siberia
				if = {
					limit = {
						OR = {
							is_owned_by = SIB
							is_owned_by = URA
						}
					}
					increase_devastation = yes
				}
			}
			every_country = {
				limit = {
					has_terrain = desert
				}
				every_owned_state = {
					increase_devastation = yes
				}
			}
			###
            every_country = {
                set_variable = { devastation_timeout = 60 }
				calculate_current_devastation = yes
                set_variable = { max_devastation = num_owned_states }
                multiply_variable = { max_devastation = 4 }
                set_variable = { devastation_ratio = ROOT.current_devastation }
                divide_variable = { devastation_ratio = max_devastation }
				if = {
					limit = {
						check_variable = { devastation_ratio < 0.01 }
					}
					add_ideas = utopian_society
				}
				else_if = {
					limit = {
						check_variable = { devastation_ratio < 0.2 }
					}
					add_ideas = stable_society
				}
				else_if = {
					limit = {
						check_variable = { devastation_ratio < 0.4 }
					}
					add_ideas = mobilizing_society
				}
				else_if = {
					limit = {
						check_variable = { devastation_ratio < 0.6 }
					}
					add_ideas = flaking_society
				}
				else_if = {
					limit = {
						check_variable = { devastation_ratio < 0.8 }
					}
					add_ideas = crumbling_society
				}
				else = {
					add_ideas = periphal_anarchy
				}
            }
        }
    }
	on_daily_ADU = {
		effect = {
            subtract_from_variable = { devastation_timeout = 1 }
			if = {
				limit = {
					check_variable = { devastation_timeout = 0 }
				}
				set_variable = { anti_threat = threat }
				set_variable = { devastation_chance = threat }
				add_to_variable = { anti_threat = -1 }
				multiply_variable = { anti_threat = -1 }
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				random_list = {
					var:devastation_chance = {
						increase_devastation_random_state = yes
					}
					var:anti_threat = {
						#
					}
				}
				add_to_variable = { devastation_timeout = 60 }
			}
			else = {
				#
			}
        }
    }
	on_weekly = {
		effect = {
			calculate_current_devastation = yes
            set_variable = { max_devastation = num_owned_states }
            multiply_variable = { max_devastation = 4 }
            set_variable = { devastation_ratio = ROOT.current_devastation }
            divide_variable = { devastation_ratio = max_devastation }
			if = {
				limit = {
					check_variable = { devastation_ratio < 0.01 }
				}
				add_ideas = utopian_society
			}
			else_if = {
				limit = {
					check_variable = { devastation_ratio < 0.2 }
				}
				add_ideas = stable_society
			}
			else_if = {
				limit = {
					check_variable = { devastation_ratio < 0.4 }
				}
				add_ideas = mobilizing_society
			}
			else_if = {
				limit = {
					check_variable = { devastation_ratio < 0.6 }
				}
				add_ideas = flaking_society
			}
			else_if = {
				limit = {
					check_variable = { devastation_ratio < 0.8 }
				}
				add_ideas = crumbling_society
			}
			else = {
				add_ideas = periphal_anarchy
			}
		}
	}
	###
	on_monthly_ADU = {
		effect = {
			set_variable = { global.total_global_devastation = 0 }
			if = {
				limit = {
					threat < 1
				}
				every_state = {
					if = {
						limit = {
							has_dynamic_modifier = {
								modifier = terminal_devastation
							}
						}
						add_to_variable = {
							global.total_global_devastation = 4
						}
					}
					else_if = {
						limit = {
							has_dynamic_modifier = {
								modifier = significant_devastation
							}
						}
						add_to_variable = {
							global.total_global_devastation = 3
						}
					}
					else_if = {
						limit = {
							has_dynamic_modifier = {
								modifier = major_devastation
							}
						}
						add_to_variable = {
							global.total_global_devastation = 2
						}
					}
					else_if = {
						limit = {
							has_dynamic_modifier = {
								modifier = notable_devastation
							}
						}
						add_to_variable = {
							global.total_global_devastation = 1
						}
					}
					else = {
						#
					}
				}
			}
			if = {
				limit = {
					threat > 0
					threat < 1
				}
				every_state = {
					limit = {
						has_dynamic_modifier = {
							modifier = no_devastation
						}
					}
					add_to_variable = {
						global.total_global_devastation = -4
					}
				}
			}
			divide_variable = { global.total_global_devastation = 1000 }
			every_country = {
				limit = {
					owns_state = 333
				}
				add_named_threat = { 
					threat = global.total_global_devastation
					name = total_global_devastation_added
				}
			}
		}
	}
	###
	on_weekly = {
		effect = {
			if = {
				limit = {
					is_ai = no
					has_country_flag = auto_ecobalance_states
					check_variable = {
						industrial_power > 200
					}
					NOT = {
						has_country_flag = has_body_tier3
					}
				}
				if = {
					limit = {
						has_country_flag = has_mind_tier3
					}
					subtract_from_variable = { industrial_power = 15 }					
				}
				else = {
					subtract_from_variable = { industrial_power = 25 }
				}
				random_owned_state = {
					limit = {
						NOT = {
							has_state_flag = devastation_reduction_timeout_flag
						}
					}
					decrease_devastation = yes
                    set_state_flag = {
                        flag = devastation_reduction_timeout_flag
                        value = 1
                        days = 60
                    }
				}
			}
		}
	}
}