on_actions = {
    on_ruling_party_change = {
        effect = {
            reset_virtues_effect = yes
        }
    }
###
	on_startup = {
		effect = {
			every_country = {
                set_variable = { diplomatic_power = 0 }
                set_variable = { diplomatic_power_gain = 0 }
                set_variable = { diplomatic_power_civilian = 0 }
                set_variable = { diplomatic_power_military = 0 }
                set_variable = { diplomatic_power_techs = 0 }
                set_variable = { diplomatic_power_trade = 0 }
                set_variable = { diplomatic_power_population = 0 }
                add_to_variable = { diplomatic_power_techs = num_researched_technologies }
                add_to_variable = { diplomatic_power_population = max_manpower_k }
                divide_variable = { diplomatic_power_population = 10000 }
                add_to_variable = { diplomatic_power_civilian = num_owned_controlled_states }
                add_to_variable = { diplomatic_power_civilian = num_of_civilian_factories }
                add_to_variable = { diplomatic_power_trade = resource_exported@superalloys }
                add_to_variable = { diplomatic_power_trade = resource_exported@polymers }
                add_to_variable = { diplomatic_power_trade = resource_exported@lithium }
                add_to_variable = { diplomatic_power_trade = resource_exported@electronics }
                add_to_variable = { diplomatic_power_trade = resource_exported@superconductors }
                add_to_variable = { diplomatic_power_trade = resource_exported@energy }
                divide_variable = { diplomatic_power_trade = 10 }
                add_to_variable = { diplomatic_power_military = num_subjects }
                add_to_variable = { diplomatic_power_military = num_ships }
                add_to_variable = { diplomatic_power_military = num_armies }
                add_to_variable = { diplomatic_power_military = num_faction_members }
                add_to_variable = { diplomatic_power_military = num_of_military_factories }
                add_to_variable = { diplomatic_power_military = num_of_naval_factories }
                #
                round_variable = diplomatic_power_civilian
                round_variable = diplomatic_power_military
                round_variable = diplomatic_power_techs
                round_variable = diplomatic_power_trade
                round_variable = diplomatic_power_population
                #
                add_to_variable = { diplomatic_power_gain = diplomatic_power_civilian }
                add_to_variable = { diplomatic_power_gain = diplomatic_power_military }
                add_to_variable = { diplomatic_power_gain = diplomatic_power_techs }
                add_to_variable = { diplomatic_power_gain = diplomatic_power_trade }
                add_to_variable = { diplomatic_power_gain = diplomatic_power_population }
                #
                divide_variable = { diplomatic_power_gain = 100 }
            }
		}
	}
    ###
    on_daily = {
		effect = {
            set_variable = { diplomatic_power_gain = 0 }
            set_variable = { diplomatic_power_civilian = 0 }
            set_variable = { diplomatic_power_military = 0 }
            set_variable = { diplomatic_power_techs = 0 }
            set_variable = { diplomatic_power_trade = 0 }
            set_variable = { diplomatic_power_population = 0 }
            add_to_variable = { diplomatic_power_techs = num_researched_technologies }
            add_to_variable = { diplomatic_power_population = max_manpower_k }
            divide_variable = { diplomatic_power_population = 10000 }
            add_to_variable = { diplomatic_power_civilian = num_owned_controlled_states }
            add_to_variable = { diplomatic_power_civilian = num_of_civilian_factories }
            add_to_variable = { diplomatic_power_trade = resource_exported@superalloys }
            add_to_variable = { diplomatic_power_trade = resource_exported@polymers }
            add_to_variable = { diplomatic_power_trade = resource_exported@lithium }
            add_to_variable = { diplomatic_power_trade = resource_exported@electronics }
            add_to_variable = { diplomatic_power_trade = resource_exported@superconductors }
            add_to_variable = { diplomatic_power_trade = resource_exported@energy }
            divide_variable = { diplomatic_power_trade = 10 }
            add_to_variable = { diplomatic_power_military = num_subjects }
            add_to_variable = { diplomatic_power_military = num_ships }
            add_to_variable = { diplomatic_power_military = num_armies }
            add_to_variable = { diplomatic_power_military = num_faction_members }
            add_to_variable = { diplomatic_power_military = num_of_military_factories }
            add_to_variable = { diplomatic_power_military = num_of_naval_factories }
            #
            round_variable = diplomatic_power_civilian
            round_variable = diplomatic_power_military
            round_variable = diplomatic_power_techs
            round_variable = diplomatic_power_trade
            round_variable = diplomatic_power_population
            #
            add_to_variable = { diplomatic_power_gain = diplomatic_power_civilian }
            add_to_variable = { diplomatic_power_gain = diplomatic_power_military }
            add_to_variable = { diplomatic_power_gain = diplomatic_power_techs }
            add_to_variable = { diplomatic_power_gain = diplomatic_power_trade }
            add_to_variable = { diplomatic_power_gain = diplomatic_power_population }
            #
            divide_variable = { diplomatic_power_gain = 100 }  
            #
            if = {
                limit = {
                    has_country_flag = doing_a_formable
                }
                add_to_variable = { diplomatic_power_gain = -1 }  
            }
            #
            add_to_variable = { diplomatic_power = diplomatic_power_gain }  
            clamp_variable = { var = diplomatic_power min = 0 max = 2000 }          
        }
    }
}
