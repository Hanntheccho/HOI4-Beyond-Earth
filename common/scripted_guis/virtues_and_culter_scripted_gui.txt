scripted_gui = {
    
    virtues_and_culture_stuff = {
        window_name = "virtues_and_culture_stuff"
        context_type = player_context
		#parent_window_token = top_bar
         
        visible = {
            if = {
                limit = {
                    is_ai = yes
                }
                always = yes
            }
            else = {
                has_country_flag = virtues_and_culture_moment_flag
            }
        }
        
        effects = {
            virtues_and_culture_close_click = {
                ROOT = {
                    clr_country_flag = virtues_and_culture_moment_flag
                }
            }
            hostility_button_click = {
                if = {
                    limit = {
                        NOT = {
                            ROOT = {
                                OR = {
                                    has_country_flag = has_benevolence_tier1
                                    has_country_flag = has_hostility_tier1
                                }
                            }
                        }
                    }
                    set_country_flag = has_hostility_tier1
                    add_dynamic_modifier = {
                        modifier = hostility_tier1_modifier
                    }
                    subtract_from_variable = { cultural_power = 150 }
                    #add_to_variable = { cultural_power_spent = 150 }
                }
                else_if = {
                    limit = {
                        AND = {
                            NOT = {
                                ROOT = {
                                    OR = {
                                        has_country_flag = has_hostility_tier2
                                        has_country_flag = has_benevolence_tier2
                                    }
                                }
                            }
                            ROOT = {
                                OR = {
                                    has_country_flag = has_hostility_tier1
                                    has_country_flag = has_benevolence_tier1
                                }
                            }
                        }
                    }
                    set_country_flag = has_hostility_tier2
                    add_dynamic_modifier = {
                        modifier = hostility_tier2_modifier
                    }
                    subtract_from_variable = { cultural_power = 200 }
                    #add_to_variable = { cultural_power_spent = 200 }
                }
                else_if = {
                    limit = {
                        ROOT = {
                            OR = {
                                has_country_flag = has_hostility_tier2
                                has_country_flag = has_benevolence_tier2
                            }
                        }
                    }
                    set_country_flag = has_hostility_tier3
                    add_dynamic_modifier = {
                        modifier = hostility_tier3_modifier
                    }
                    subtract_from_variable = { cultural_power = 300 }
                    #add_to_variable = { cultural_power_spent = 300 }
                }
            }
            benevolence_button_click = {
                if = {
                    limit = {
                        NOT = {
                            ROOT = {
                                OR = {
                                    has_country_flag = has_hostility_tier1
                                    has_country_flag = has_benevolence_tier1
                                }
                            }
                        }
                    }
                    set_country_flag = has_benevolence_tier1
                    add_dynamic_modifier = {
                        modifier = benevolence_tier1_modifier
                    }
                    subtract_from_variable = { cultural_power = 150 }
                    #add_to_variable = { cultural_power_spent = 150 }
                }
                else_if = {
                    limit = {
                        AND = {
                            NOT = {
                                ROOT = {
                                    OR = {
                                        has_country_flag = has_hostility_tier2
                                        has_country_flag = has_benevolence_tier2
                                    }
                                }
                            }
                            ROOT = {
                                OR = {
                                    has_country_flag = has_hostility_tier1
                                    has_country_flag = has_benevolence_tier1
                                }
                            }
                        }
                    }
                    set_country_flag = has_benevolence_tier2
                    add_dynamic_modifier = {
                        modifier = benevolence_tier2_modifier
                    }
                    subtract_from_variable = { cultural_power = 200 }
                    #add_to_variable = { cultural_power_spent = 200 }
                }
                else_if = {
                    limit = {
                        ROOT = {
                            OR = {
                                has_country_flag = has_hostility_tier2
                                has_country_flag = has_benevolence_tier2
                            }
                        }
                    }
                    set_country_flag = has_benevolence_tier3
                    add_dynamic_modifier = {
                        modifier = benevolence_tier3_modifier
                    }
                    subtract_from_variable = { cultural_power = 300 }
                    #add_to_variable = { cultural_power_spent = 300 }
                }
            }
            tradition_button_click = {
                if = {
                    limit = {
                        NOT = {
                            ROOT = {
                                OR = {
                                    has_country_flag = has_progress_tier1
                                    has_country_flag = has_tradition_tier1
                                }
                            }
                        }
                    }
                    set_country_flag = has_tradition_tier1
                    add_dynamic_modifier = {
                        modifier = tradition_tier1_modifier
                    }
                    subtract_from_variable = { cultural_power = 150 }
                    #add_to_variable = { cultural_power_spent = 150 }
                }
                else_if = {
                    limit = {
                        AND = {
                            NOT = {
                                ROOT = {
                                    OR = {
                                        has_country_flag = has_progress_tier2
                                        has_country_flag = has_tradition_tier2
                                    }
                                }
                            }
                            ROOT = {
                                OR = {
                                    has_country_flag = has_progress_tier1
                                    has_country_flag = has_tradition_tier1
                                }
                            }
                        }
                    }
                    set_country_flag = has_tradition_tier2
                    set_country_flag = tradition_two
                    #add_dynamic_modifier = {
                    #    modifier = tradition_tier2_modifier
                    #}
                    subtract_from_variable = { cultural_power = 200 }
                    #add_to_variable = { cultural_power_spent = 200 }
                }
                else_if = {
                    limit = {
                        ROOT = {
                            OR = {
                                has_country_flag = has_progress_tier2
                                has_country_flag = has_tradition_tier2
                            }
                        }
                    }
                    set_country_flag = has_tradition_tier3
                    set_country_flag = tradition_three
                    subtract_from_variable = { cultural_power = 300 }
                    #add_to_variable = { cultural_power_spent = 300 }
                }
            }
            progress_button_click = {
                if = {
                    limit = {
                        NOT = {
                            ROOT = {
                                OR = {
                                    has_country_flag = has_tradition_tier1
                                    has_country_flag = has_progress_tier1
                                }
                            }
                        }
                    }
                    set_country_flag = has_progress_tier1
                    add_dynamic_modifier = {
                        modifier = progress_tier1_modifier
                    }
                    subtract_from_variable = { cultural_power = 150 }
                    #add_to_variable = { cultural_power_spent = 150 }
                }
                else_if = {
                    limit = {
                        AND = {
                            NOT = {
                                ROOT = {
                                    OR = {
                                        has_country_flag = has_tradition_tier2
                                        has_country_flag = has_progress_tier2
                                    }
                                }
                            }
                            ROOT = {
                                OR = {
                                    has_country_flag = has_tradition_tier1
                                    has_country_flag = has_progress_tier1
                                }
                            }
                        }
                    }
                    set_country_flag = has_progress_tier2
                    set_country_flag = progress_two
                    subtract_from_variable = { cultural_power = 200 }
                    #add_to_variable = { cultural_power_spent = 200 }
                }
                else_if = {
                    limit = {
                        ROOT = {
                            OR = {
                                has_country_flag = has_tradition_tier2
                                has_country_flag = has_progress_tier2
                            }
                        }
                    }
                    set_country_flag = has_progress_tier3
                    add_dynamic_modifier = {
                        modifier = progress_tier3_modifier
                    }
                    subtract_from_variable = { cultural_power = 300 }
                    #add_to_variable = { cultural_power_spent = 300 }
                }
            }
            body_button_click = {
                if = {
                    limit = {
                        NOT = {
                            ROOT = {
                                OR = {
                                    has_country_flag = has_mind_tier1
                                    has_country_flag = has_body_tier1
                                }
                            }
                        }
                    }
                    set_country_flag = has_body_tier1
                    add_dynamic_modifier = {
                        modifier = body_tier1_modifier
                    }
                    subtract_from_variable = { cultural_power = 150 }
                    #add_to_variable = { cultural_power_spent = 150 }
                }
                else_if = {
                    limit = {
                        AND = {
                            NOT = {
                                ROOT = {
                                    OR = {
                                        has_country_flag = has_mind_tier2
                                        has_country_flag = has_body_tier2
                                    }
                                }
                            }
                            ROOT = {
                                OR = {
                                    has_country_flag = has_mind_tier1
                                    has_country_flag = has_body_tier1
                                }
                            }
                        }
                    }
                    set_country_flag = has_body_tier2
                    add_dynamic_modifier = {
                        modifier = body_tier2_modifier
                    }
                    subtract_from_variable = { cultural_power = 200 }
                    #add_to_variable = { cultural_power_spent = 200 }
                }
                else_if = {
                    limit = {
                        ROOT = {
                            OR = {
                                has_country_flag = has_mind_tier2
                                has_country_flag = has_body_tier2
                            }
                        }
                    }
                    set_country_flag = has_body_tier3
                    add_dynamic_modifier = {
                        modifier = body_tier3_modifier
                    }
                    subtract_from_variable = { cultural_power = 300 }
                    #add_to_variable = { cultural_power_spent = 300 }
                }
            }
            mind_button_click = {
                if = {
                    limit = {
                        NOT = {
                            ROOT = {
                                OR = {
                                    has_country_flag = has_body_tier1
                                    has_country_flag = has_mind_tier1
                                }
                            }
                        }
                    }
                    set_country_flag = has_mind_tier1
                    add_dynamic_modifier = {
                        modifier = mind_tier1_modifier
                    }
                    subtract_from_variable = { cultural_power = 150 }
                    #add_to_variable = { cultural_power_spent = 150 }
                }
                else_if = {
                    limit = {
                        AND = {
                            NOT = {
                                ROOT = {
                                    OR = {
                                        has_country_flag = has_body_tier2
                                        has_country_flag = has_mind_tier2
                                    }
                                }
                            }
                            ROOT = {
                                OR = {
                                    has_country_flag = has_body_tier1
                                    has_country_flag = has_mind_tier1
                                }
                            }
                        }
                    }
                    set_country_flag = has_mind_tier2
                    add_dynamic_modifier = {
                        modifier = mind_tier2_modifier
                    }
                    subtract_from_variable = { cultural_power = 200 }
                    #add_to_variable = { cultural_power_spent = 200 }
                }
                else_if = {
                    limit = {
                        ROOT = {
                            OR = {
                                has_country_flag = has_body_tier2
                                has_country_flag = has_mind_tier2
                            }
                        }
                    }
                    set_country_flag = has_mind_tier3
                    add_dynamic_modifier = {
                        modifier = mind_tier3_modifier
                    }
                    subtract_from_variable = { cultural_power = 300 }
                    #add_to_variable = { cultural_power_spent = 300 }
                }
            }
        }
        
        triggers = {
            #reset_virtues_button_click_enabled = {
            #    always = yes
            #}
            hostility_button_click_enabled = {
                NOT = {
                    ROOT = {
                            OR = {
                            has_country_flag = has_hostility_tier3
                            has_country_flag = has_benevolence_tier1
                        }
                    }
                }
                if = {
                    limit = {
                        NOT = {
                            has_country_flag = has_hostility_tier2
                            has_country_flag = has_hostility_tier1
                        }
                    }
                    check_variable = { cultural_power > 149 }
                }
                else_if = {
                    limit = {
                        has_country_flag = has_hostility_tier1
                    }
                    check_variable = { cultural_power > 199 }
                }
                else_if = {
                    limit = {
                        has_country_flag = has_hostility_tier2
                    }
                    check_variable = { cultural_power > 299 }
                    has_global_flag = final_war_flag
                }
            }
            benevolence_button_click_enabled = {
                NOT = {
                    ROOT = {
                            OR = {
                            has_country_flag = has_hostility_tier1
                            has_country_flag = has_benevolence_tier3
                        }
                    }
                }
                if = {
                    limit = {
                        NOT = {
                            has_country_flag = has_benevolence_tier2
                            has_country_flag = has_benevolence_tier1
                        }
                    }
                    check_variable = { cultural_power > 149 }
                }
                else_if = {
                    limit = {
                        has_country_flag = has_benevolence_tier1
                    }
                    check_variable = { cultural_power > 199 }
                }
                else_if = {
                    limit = {
                        has_country_flag = has_benevolence_tier2
                    }
                    check_variable = { cultural_power > 299 }
                    has_global_flag = final_war_flag
                }
            }
            tradition_button_click_enabled = {
                NOT = {
                    ROOT = {
                            OR = {
                            has_country_flag = has_tradition_tier3
                            has_country_flag = has_progress_tier1
                        }
                    }
                }
                if = {
                    limit = {
                        NOT = {
                            has_country_flag = has_tradition_tier2
                            has_country_flag = has_tradition_tier1
                        }
                    }
                    check_variable = { cultural_power > 149 }
                }
                else_if = {
                    limit = {
                        has_country_flag = has_tradition_tier1
                    }
                    check_variable = { cultural_power > 199 }
                }
                else_if = {
                    limit = {
                        has_country_flag = has_tradition_tier2
                    }
                    check_variable = { cultural_power > 299 }
                    has_global_flag = final_war_flag
                }
            }
            progress_button_click_enabled = {
                NOT = {
                    ROOT = {
                            OR = {
                            has_country_flag = has_progress_tier3
                            has_country_flag = has_tradition_tier1
                        }
                    }
                }
                if = {
                    limit = {
                        NOT = {
                            has_country_flag = has_progress_tier2
                            has_country_flag = has_progress_tier1
                        }
                    }
                    check_variable = { cultural_power > 149 }
                }
                else_if = {
                    limit = {
                        has_country_flag = has_progress_tier1
                    }
                    check_variable = { cultural_power > 199 }
                }
                else_if = {
                    limit = {
                        has_country_flag = has_progress_tier2
                    }
                    check_variable = { cultural_power > 299 }
                    has_global_flag = final_war_flag
                }
            }
            body_button_click_enabled = {
                NOT = {
                    ROOT = {
                            OR = {
                            has_country_flag = has_body_tier3
                            has_country_flag = has_mind_tier1
                        }
                    }
                }
                if = {
                    limit = {
                        NOT = {
                            has_country_flag = has_body_tier2
                            has_country_flag = has_body_tier1
                        }
                    }
                    check_variable = { cultural_power > 149 }
                }
                else_if = {
                    limit = {
                        has_country_flag = has_body_tier1
                    }
                    check_variable = { cultural_power > 199 }
                }
                else_if = {
                    limit = {
                        has_country_flag = has_body_tier2
                    }
                    check_variable = { cultural_power > 299 }
                    has_global_flag = final_war_flag
                }
            }
            mind_button_click_enabled = {
                NOT = {
                    ROOT = {
                            OR = {
                            has_country_flag = has_body_tier1
                            has_country_flag = has_mind_tier3
                        }
                    }
                }
                if = {
                    limit = {
                        NOT = {
                            has_country_flag = has_mind_tier2
                            has_country_flag = has_mind_tier1
                        }
                    }
                    check_variable = { cultural_power > 149 }
                }
                else_if = {
                    limit = {
                        has_country_flag = has_mind_tier1
                    }
                    check_variable = { cultural_power > 199 }
                }
                else_if = {
                    limit = {
                        has_country_flag = has_mind_tier2
                    }
                    check_variable = { cultural_power > 299 }
                    has_global_flag = final_war_flag
                }
            }

            ###
            supremacy_word_visible = {
				has_government = supremacy
			}
			purity_word_visible = {
				has_government = purity
			}
			harmony_word_visible = {
				has_government = harmony
			}
			neutral_word_visible = {
				has_government = neutral
			}
			divinity_word_visible = {
				has_government = divinity
			}
			voracity_word_visible = {
				has_government = voracity
			}
			mastery_word_visible = {
				has_government = mastery
			}

            supremacy_icon_visible = {
				has_government = supremacy
			}
			purity_icon_visible = {
				has_government = purity
			}
			harmony_icon_visible = {
				has_government = harmony
			}
			neutral_icon_visible = {
				has_government = neutral
			}
			divinity_icon_visible = {
				has_government = divinity
			}
			voracity_icon_visible = {
				has_government = voracity
			}
			mastery_icon_visible = {
				has_government = mastery
			}

            supremacy_line_visible = {
				has_country_flag = has_tradition_tier1
			}
			purity_line_visible = {
				has_country_flag = has_hostility_tier1
			}
			harmony_line_visible = {
				has_country_flag = has_mind_tier1
			}
			divinity_line_visible = {
				has_country_flag = has_progress_tier1
			}
			voracity_line_visible = {
				has_country_flag = has_benevolence_tier1
			}
			mastery_line_visible = {
				has_country_flag = has_body_tier1
			}
            ###
            supremacy_fade_visible = {
				has_country_flag = has_tradition_tier2
			}
			purity_fade_visible = {
				has_country_flag = has_hostility_tier2
			}
			harmony_fade_visible = {
				has_country_flag = has_mind_tier2
			}
			divinity_fade_visible = {
				has_country_flag = has_progress_tier2
			}
			voracity_fade_visible = {
				has_country_flag = has_benevolence_tier2
			}
			mastery_fade_visible = {
				has_country_flag = has_body_tier2
			}
            ###
            supremacy_fade_2_visible = {
				has_country_flag = has_tradition_tier3
			}
			purity_fade_2_visible = {
				has_country_flag = has_hostility_tier3
			}
			harmony_fade_2_visible = {
				has_country_flag = has_mind_tier3
			}
			divinity_fade_2_visible = {
				has_country_flag = has_progress_tier3
			}
			voracity_fade_2_visible = {
				has_country_flag = has_benevolence_tier3
			}
			mastery_fade_2_visible = {
				has_country_flag = has_body_tier3
			}
            ###
        }

        ai_enabled = {
            always = yes
        }

        ai_test_interval = 300

        ai_check = {
            check_variable = {
                cultural_power > 150
            }
		}

        ai_weights = {
            hostility_button_click = {
                ai_will_do = {
                    factor = 1
                }
            }
            benevolence_button_click = {
                ai_will_do = {
                    factor = 1
                }
            }
            tradition_button_click = {
                ai_will_do = {
                    factor = 1
                }
            }
            progress_button_click = {
                ai_will_do = {
                    factor = 1
                }
            }
            body_button_click = {
                ai_will_do = {
                    factor = 1
                }
            }
            mind_button_click = {
                ai_will_do = {
                    factor = 1
                }
            }
        }
    }
}