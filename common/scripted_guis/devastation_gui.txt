scripted_gui = {
	devastation_gui = {
		context_type = selected_state_context
		parent_window_token = selected_state_view
		
		window_name = "devastation_gui_window"
		
		visible = {
            always = yes
		}
		
		effects = {
			reduce_devastation_button_click = {
                if = {
                    limit = {
                        ROOT = {
                            has_government = harmony
                            has_country_flag = has_mind_tier3
                        }
                    }
                    THIS = {
                        decrease_devastation_more = yes
                        set_state_flag = {
                            flag = devastation_reduction_timeout_flag
                            value = 1
                            days = 20
                        }
                    }
                    ROOT = {
                        subtract_from_variable = { industrial_power = 10 }
                        subtract_from_variable = { current_devastation = 1 }
                    }
                }
                else_if = {
                    limit = {
                        ROOT = {
                            has_government = harmony
                        }
                    }
                    THIS = {
                        decrease_devastation = yes
                        set_state_flag = {
                            flag = devastation_reduction_timeout_flag
                            value = 1
                            days = 20
                        }
                    }
                    ROOT = {
                        subtract_from_variable = { industrial_power = 10 }
                        subtract_from_variable = { current_devastation = 1 }
                    }
                }
                else = {
                    THIS = {
                        decrease_devastation = yes
                        set_state_flag = {
                            flag = devastation_reduction_timeout_flag
                            value = 1
                            days = 60
                        }
                    }
                    ROOT = {
                        subtract_from_variable = { industrial_power = 25 }
		                subtract_from_variable = { current_devastation = 1 }
                    }
                }
			}
		}
        triggers = {
            reduce_devastation_button_click_enabled = {
                if = {
                    limit = {
                        ROOT = {
                            has_government = harmony
                            has_country_flag = has_mind_tier3
                        }
                    }
                    THIS = {
                        OR = {
                            is_owned_by = ROOT
                            OWNER = { is_ally_with = ROOT }
                        }
                        OR = {
                            has_dynamic_modifier = {
                                modifier = minor_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = notable_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = major_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = significant_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = terminal_devastation
                            }
                        }
                        NOT = {
                            has_state_flag = devastation_reduction_timeout_flag
                        }
                    }
                    ROOT = { 
                        check_variable = {
                            var = industrial_power
                            value = 10
                            compare = greater_than_or_equals
                        }
                    }
                }
                else_if = {
                    limit = {
                        ROOT = {
                            has_government = harmony
                        }
                    }
                    THIS = {
                        OR = {
                            is_owned_by = ROOT
                            OWNER = { is_ally_with = ROOT }
                        }
                        OR = {
                            has_dynamic_modifier = {
                                modifier = notable_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = major_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = significant_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = terminal_devastation
                            }
                        }
                        NOT = {
                            has_state_flag = devastation_reduction_timeout_flag
                        }
                    }
                    ROOT = { 
                        check_variable = {
                            var = industrial_power
                            value = 10
                            compare = greater_than_or_equals
                        }
                    }
                }
                else = {
                    THIS = {
                        OR = {
                            is_owned_by = ROOT
                            OWNER = { is_ally_with = ROOT }
                        }
                        OR = {
                            has_dynamic_modifier = {
                                modifier = notable_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = major_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = significant_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = terminal_devastation
                            }
                        }
                        NOT = {
                            has_state_flag = devastation_reduction_timeout_flag
                        }
                        NOT = {
                            ROOT = {
                                has_idea = the_final_war_idea
                            }
                        }
                    }
                    ROOT = {
                        check_variable = {
                            var = industrial_power
                            value = 25
                            compare = greater_than_or_equals
                        }
                    }
                }
            }
            reduce_devastation_load_click_enabled = {
                if = {
                    limit = {
                        ROOT = {
                            has_government = harmony
                            has_country_flag = has_mind_tier3
                        }
                    }
                    THIS = {
                        OR = {
                            is_owned_by = ROOT
                            OWNER = { is_ally_with = ROOT }
                        }
                        OR = {
                            has_dynamic_modifier = {
                                modifier = minor_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = notable_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = major_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = significant_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = terminal_devastation
                            }
                        }
                        NOT = {
                            has_state_flag = devastation_reduction_timeout_flag
                        }
                    }
                    ROOT = { 
                        check_variable = {
                            var = industrial_power
                            value = 10
                            compare = greater_than_or_equals
                        }
                    }
                }
                else_if = {
                    limit = {
                        ROOT = {
                            has_government = harmony
                        }
                    }
                    THIS = {
                        OR = {
                            is_owned_by = ROOT
                            OWNER = { is_ally_with = ROOT }
                        }
                        OR = {
                            has_dynamic_modifier = {
                                modifier = notable_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = major_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = significant_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = terminal_devastation
                            }
                        }
                        NOT = {
                            has_state_flag = devastation_reduction_timeout_flag
                        }
                    }
                    ROOT = { 
                        check_variable = {
                            var = industrial_power
                            value = 10
                            compare = greater_than_or_equals
                        }
                    }
                }
                else = {
                    THIS = {
                        OR = {
                            is_owned_by = ROOT
                            OWNER = { is_ally_with = ROOT }
                        }
                        OR = {
                            has_dynamic_modifier = {
                                modifier = notable_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = major_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = significant_devastation
                            }
                            has_dynamic_modifier = {
                                modifier = terminal_devastation
                            }
                        }
                        NOT = {
                            has_state_flag = devastation_reduction_timeout_flag
                        }
                        NOT = {
                            ROOT = {
                                has_idea = the_final_war_idea
                            }
                        }
                    }
                    ROOT = {
                        check_variable = {
                            var = industrial_power
                            value = 25
                            compare = greater_than_or_equals
                        }
                    }
                }
            }

            #
            no_devastation_icon_click_enabled = {
                has_dynamic_modifier = {
                    modifier = no_devastation
                }
            }
            minor_devastation_icon_click_enabled = {
                has_dynamic_modifier = {
                    modifier = minor_devastation
                }
            }
            notable_devastation_icon_click_enabled = {
                has_dynamic_modifier = {
                    modifier = notable_devastation
                }
            }
            major_devastation_icon_click_enabled = {
                has_dynamic_modifier = {
                    modifier = major_devastation
                }
            }
            significant_devastation_icon_click_enabled = {
                has_dynamic_modifier = {
                    modifier = significant_devastation
                }
            }
            terminal_devastation_icon_click_enabled = {
                has_dynamic_modifier = {
                    modifier = terminal_devastation
                }
            }
        }

        ai_enabled = {
            always = yes
        }

        ai_test_interval = 300

        ai_check = {
            check_variable = {
                industrial_power > 25
            }
		}

        ai_weights = {
            reduce_devastation_button_click = {
                ai_will_do = {
                    factor = 0
                    modifier = {
                        OWNER = {
                            check_variable = {
                                industrial_power > 500
                            }
                        }
                        add = 100000
			        }
                    modifier = {	
                        OWNER = {
                            has_idea = crumbling_society
                        }
                        add = 100000
			        }
                }
            }
        }
	}
}