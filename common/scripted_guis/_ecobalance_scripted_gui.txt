scripted_gui = {
    auto_ecobalance_window_gui = {
		context_type = player_context
		parent_window_name = "decision_grid_container"
		
		window_name = "auto_ecobalance_window"

        visible = {
            always = yes
        }

        ai_enabled = {
            always = no
        }

        effects = {
            auto_ecobalance_button_click = {
				if = {
					limit = {
						has_country_flag = auto_ecobalance_states
					}
					clr_country_flag = auto_ecobalance_states
				}
				else = {
					set_country_flag = auto_ecobalance_states
				}
            }
		}

		triggers = {
            #
        }
    } 
###
	devastation_gui = {
		context_type = selected_state_context
		parent_window_token = selected_state_view
		
		window_name = "ecobalance_gui_window"
		
		visible = {
            always = yes
		}
		
		effects = {
			reduce_devastation_button_click = {
                THIS = {
                    decrease_devastation = yes
                    set_state_flag = {
                        flag = devastation_reduction_timeout_flag
                        value = 1
                        days = 60
                    }
                }
                ROOT = {
                    subtract_from_variable = { industrial_power = 25 }
                }
			}
            reduce_devastation_button_harmony_click = {
                THIS = {
                    decrease_devastation = yes
                    set_state_flag = {
                        flag = devastation_reduction_timeout_flag
                        value = 1
                        days = 60
                    }
                }
                ROOT = {
                    subtract_from_variable = { industrial_power = 15 }
                }
            }
            reduce_devastation_button_mastery_click = {
                THIS = {
                    increase_devastation = yes
                    set_state_flag = {
                        flag = devastation_reduction_timeout_flag
                        value = 1
                        days = 60
                    }
                    if = {
                        limit = {
                            ROOT = {
                                has_war = yes
                            }
                            free_building_slots = {
                                building = arms_factory
                                size > 0
                                include_locked = no
                            }
                        }
                        add_building_construction = {
                            type = arms_factory
                            level = 1
                            instant_build = yes
                        }
                    }
                    else_if = {
                        limit = {
                            free_building_slots = {
                                building = industrial_complex
                                size > 0
                                include_locked = no
                            }
                        }
                        add_building_construction = {
                            type = industrial_complex
                            level = 1
                            instant_build = yes
                        }
                    }
                    if = {
                        limit = {
                            infrastructure < 5
                        }
                        add_building_construction = {
				        	type = infrastructure
				        	level = 1
				        	instant_build = yes
				        }
                    }
                    if = {
                        limit = {
                            NOT = {
                                has_state_flag = already_exploited_by_mastery
                            }
                        }
                        if = {
                            limit = {
                                has_resources_amount = {
                                    resource = oil
                                    amount > 0
                                }
                            }
                            add_resource = {
                                type = oil
                                amount = 10
                            }
                        }
                        if = {
                            limit = {
                                has_resources_amount = {
                                    resource = rubber
                                    amount > 0
                                }
                            }
                            add_resource = {
                                type = rubber
                                amount = 10
                            }
                        }
                        if = {
                            limit = {
                                has_resources_amount = {
                                    resource = tungsten
                                    amount > 0
                                }
                            }
                            add_resource = {
                                type = tungsten
                                amount = 10
                            }
                        }
                        if = {
                            limit = {
                                has_resources_amount = {
                                    resource = chromium
                                    amount > 0
                                }
                            }
                            add_resource = {
                                type = chromium
                                amount = 10
                            }
                        }
                        if = {
                            limit = {
                                has_resources_amount = {
                                    resource = steel
                                    amount > 0
                                }
                            }
                            add_resource = {
                                type = steel
                                amount = 10
                            }
                        }
                        if = {
                            limit = {
                                has_resources_amount = {
                                    resource = aluminium
                                    amount > 0
                                }
                            }
                            add_resource = {
                                type = aluminium
                                amount = 10
                            }
                        }
                        set_state_flag = already_exploited_by_mastery
                    }                   
                }
                ROOT = {
                    subtract_from_variable = { industrial_power = 40 }
                }
            }
		}
        triggers = {
            reduce_devastation_button_visible = {
                ROOT = {
                    NOT = {
                        OR = {
                            has_country_flag = has_mind_tier3
                            has_country_flag = has_body_tier3
                        }
                    }
                }
            }
            reduce_devastation_load_visible = {
                ROOT = {
                    NOT = {
                        OR = {
                            has_country_flag = has_mind_tier3
                            has_country_flag = has_body_tier3
                        }
                    }
                }
            }
            reduce_devastation_load_click_enabled = {
                THIS = {
                    OR = {
                        is_owned_by = ROOT
                        OWNER = { is_ally_with = ROOT }
                    }
                    OR = {
                        has_dynamic_modifier = {
                            modifier = notable_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = major_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = significant_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = terminal_devastation
                        }
                    }
                    NOT = {
                        has_state_flag = devastation_reduction_timeout_flag
                    }
                }
                ROOT = {
                    check_variable = {
                        var = industrial_power
                        value = 25
                        compare = greater_than_or_equals
                    }
                }
            }
            reduce_devastation_button_click_enabled = {
                THIS = {
                    OR = {
                        is_owned_by = ROOT
                        OWNER = { is_ally_with = ROOT }
                    }
                    OR = {
                        has_dynamic_modifier = {
                            modifier = notable_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = major_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = significant_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = terminal_devastation
                        }
                    }
                    NOT = {
                        has_state_flag = devastation_reduction_timeout_flag
                    }
                }
                ROOT = {
                    check_variable = {
                        var = industrial_power
                        value = 25
                        compare = greater_than_or_equals
                    }
                }
            }
            reduce_devastation_button_harmony_visible = {
                ROOT = {
                    has_country_flag = has_mind_tier3
                }
            }
            reduce_devastation_load_harmony_visible = {
                ROOT = {
                    has_country_flag = has_mind_tier3
                }
            }
            reduce_devastation_load_harmony_click_enabled = {
                THIS = {
                    OR = {
                        is_owned_by = ROOT
                        OWNER = { is_ally_with = ROOT }
                    }
                    OR = {
                        has_dynamic_modifier = {
                            modifier = minor_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = notable_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = major_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = significant_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = terminal_devastation
                        }
                    }
                    NOT = {
                        has_state_flag = devastation_reduction_timeout_flag
                    }
                }
                ROOT = { 
                    check_variable = {
                        var = industrial_power
                        value = 25
                        compare = greater_than_or_equals
                    }
                }
            }
            reduce_devastation_button_harmony_click_enabled = {
                THIS = {
                    OR = {
                        is_owned_by = ROOT
                        OWNER = { is_ally_with = ROOT }
                    }
                    OR = {
                        has_dynamic_modifier = {
                            modifier = minor_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = notable_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = major_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = significant_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = terminal_devastation
                        }
                    }
                    NOT = {
                        has_state_flag = devastation_reduction_timeout_flag
                    }
                }
                ROOT = { 
                    check_variable = {
                        var = industrial_power
                        value = 15
                        compare = greater_than_or_equals
                    }
                }
            }
            reduce_devastation_button_mastery_visible = {
                ROOT = { 
                    has_country_flag = has_body_tier3
                }
            }
            reduce_devastation_load_mastery_visible = {
                ROOT = { 
                    has_country_flag = has_body_tier3
                }
            }
            reduce_devastation_load_mastery_click_enabled = {
                THIS = {
                    OR = {
                        is_owned_by = ROOT
                        OWNER = { is_ally_with = ROOT }
                    }
                    OR = {
                        has_dynamic_modifier = {
                            modifier = no_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = minor_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = notable_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = major_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = significant_devastation
                        }
                    }
                    NOT = {
                        has_state_flag = devastation_reduction_timeout_flag
                    }
                }
                ROOT = {
                    check_variable = {
                        var = industrial_power
                        value = 40
                        compare = greater_than_or_equals
                    }
                }
            }
            reduce_devastation_button_mastery_click_enabled = {
                THIS = {
                    OR = {
                        is_owned_by = ROOT
                        OWNER = { is_ally_with = ROOT }
                    }
                    OR = {
                        has_dynamic_modifier = {
                            modifier = no_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = minor_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = notable_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = major_devastation
                        }
                        has_dynamic_modifier = {
                            modifier = significant_devastation
                        }
                    }
                    NOT = {
                        has_state_flag = devastation_reduction_timeout_flag
                    }
                }
                ROOT = {
                    check_variable = {
                        var = industrial_power
                        value = 40
                        compare = greater_than_or_equals
                    }
                }
            }
            #
            no_devastation_icon_visible = {
                has_dynamic_modifier = {
                    modifier = no_devastation
                }
            }
            minor_devastation_icon_visible = {
                has_dynamic_modifier = {
                    modifier = minor_devastation
                }
            }
            notable_devastation_icon_visible = {
                has_dynamic_modifier = {
                    modifier = notable_devastation
                }
            }
            major_devastation_icon_visible = {
                has_dynamic_modifier = {
                    modifier = major_devastation
                }
            }
            significant_devastation_icon_visible = {
                has_dynamic_modifier = {
                    modifier = significant_devastation
                }
            }
            terminal_devastation_icon_visible = {
                has_dynamic_modifier = {
                    modifier = terminal_devastation
                }
            }
        }

        ai_enabled = {
            always = yes
        }

        ai_test_interval = 300

        ai_check = {
            check_variable = {
                industrial_power > 25
            }
		}

        ai_weights = {
            reduce_devastation_button_click = {
                ai_will_do = {
                    factor = 0
                    modifier = {
                        OWNER = {
                            check_variable = {
                                industrial_power > 200
                            }
                        }
                        add = 100
			        }
                    modifier = {	
                        OWNER = {
                            has_idea = crumbling_society
                        }
                        add = 10000
			        }
                    #
                    modifier = {
                        OWNER = {
                            NOT = {
                                has_government = harmony
                            }
                        }
                        add = -90
			        }
                }
            }
            reduce_devastation_button_harmony_click = {
                ai_will_do = {
                    factor = 1
                    modifier = {
                        ROOT = {
                            check_variable = {
                                industrial_power > 200
                            }
                        }
                        add = 100
			        }
                    modifier = {	
                        OWNER = {
                            has_idea = flaking_society
                        }
                        add = 10000
			        }
                }
            }
            reduce_devastation_button_mastery_click = {
                ai_will_do = {
                    factor = 0
                    modifier = {
                        ROOT = {
                            check_variable = {
                                industrial_power > 100
                            }
                        }
                        OWNER = {                            
                            NOT =  {
                                has_idea = crumbling_society
                            }
                        }
                        THIS = {
                            OR = {
                                free_building_slots = {
                                    building = arms_factory
                                    size > 0
                                    include_locked = no
                                }
                                free_building_slots = {
                                    building = industrial_complex
                                    size > 0
                                    include_locked = no
                                }
                            }
                        }
                        add = 1
			        }
                    modifier = {
                        ROOT = {
                            check_variable = {
                                industrial_power > 200
                            }
                        }
                        OWNER = {
                            NOT =  {
                                has_idea = crumbling_society
                            }
                        }
                        THIS = {
                            OR = {
                                free_building_slots = {
                                    building = arms_factory
                                    size > 0
                                    include_locked = no
                                }
                                free_building_slots = {
                                    building = industrial_complex
                                    size > 0
                                    include_locked = no
                                }
                            }
                        }
                        add = 10
			        }
                }
            }
        }
	}
}